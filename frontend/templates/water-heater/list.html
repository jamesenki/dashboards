{% extends "layouts/base.html" %}

{% block title %}Water Heaters{% endblock %}

{% block head %}
<!-- Include CSS fixes -->
<link rel="stylesheet" href="/static/css/aquatherm-fixes.css">
<link rel="stylesheet" href="/static/css/aquatherm-cards.css">
<!-- NAVIGATION NOTE: All navigation scripts have been consolidated into fix-navigation.js -->
{% endblock %}

{% block nav %}
<li><a href="/water-heaters" class="active">All Devices</a></li>
<li><a href="/water-heaters/new">Add New</a></li>
{% endblock %}

{% block page_title %}Water Heaters{% endblock %}

{% block content %}
<div id="water-heater-list" class="dashboard"></div>
{% endblock %}

{% block scripts %}
<!-- CRITICAL FIX: This script must load first to properly fix navigation issues -->
<script src="/static/js/fix-navigation.js?v=20250408"></script>
<!-- Clean up any mock water heaters that might be injected by other scripts -->
<script src="/static/js/clear-mock-data.js"></script>

<!-- DISABLED: AquaTherm test helper that injects mock water heaters -->
<!-- <script src="/static/js/aquatherm-test-helper.js"></script> -->
<script src="/static/js/api.js"></script>
<script src="/static/js/debug.js"></script>
<!-- Add data source indicator to show database/mock status -->
<script src="/static/js/data-source-indicator.js?v=20250405"></script>
<!-- FORCE LATEST VERSION: Added version to prevent caching issues across networks -->
<script src="/static/js/water-heater-new.js?v=20250405"></script>
<!-- DISABLED: AquaTherm specific scripts -->
<!-- <script src="/static/js/aquatherm-water-heater.js"></script> -->
<!-- <script src="/static/js/aquatherm-ui-debug.js"></script> -->
<script src="/static/js/redirect-to-valid-heater.js?v=20250405"></script>
<!-- DISABLED: Test and fix scripts that may add mock water heaters -->
<!-- <script src="/static/js/tests/aquatherm-card-test.js"></script> -->
<!-- <script src="/static/js/aquatherm-fix.js"></script> -->
<!-- <script src="/static/js/aquatherm-card-fix.js"></script> -->
<!-- ARCHIVED: All navigation scripts have been consolidated into fix-navigation.js -->
<!-- Add water heater patch to ensure all water heaters display correctly (Fixed version) -->
<script src="/static/js/water-heater-patch-fixed.js?v=20250408"></script>
<!-- TDD approach: Add deduplication test script to verify our fix works -->
<script src="/static/js/tests/water-heater-deduplication.test.js?v=20250408"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        new WaterHeaterList('water-heater-list');
    });
</script>
{% endblock %}
