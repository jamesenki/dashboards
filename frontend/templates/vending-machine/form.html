{% extends "layouts/base.html" %}

{% block title %}{% if machine_id %}Edit{% else %}Add New{% endif %} Vending Machine{% endblock %}

{% block nav %}
<li><a href="/vending-machines">All Devices</a></li>
<li><a href="/vending-machines/new" {% if not machine_id %}class="active"{% endif %}>Add New</a></li>
{% endblock %}

{% block page_title %}{% if machine_id %}Edit{% else %}Add New{% endif %} Vending Machine{% endblock %}

{% block content %}
<div id="vending-machine-form"></div>
{% endblock %}

{% block scripts %}
<script src="/static/js/api.js?v={{now.timestamp()}}"></script>
<script src="/static/js/vending-machine.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const urlParts = window.location.pathname.split('/');
        const machineId = urlParts.length > 3 ? urlParts[urlParts.length - 1] : null;
        new VendingMachineForm('vending-machine-form', machineId);
    });
</script>
{% endblock %}
